# A7: High-level architecture. Privileges. Web resources specification
 
## 1. Overview
 
| Module                                     | Description                                                                                                                                                                                                                                     |
| ------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| M01: Authentication And Indiviudal Profile | Web resources associated with user login and logout and the manangement of his/her profile and general serch capabilities                                                                                      |
| M02: User Administration / Static Pages    | Web resources for administrator profile, including user management like giving and taking bans to user and bands, giving warns to users and bands, create, edit and delete genres and skills and manage user permissions                        |
| M03: User Feed                              | Web resources for the main page of the user. This module will have resources to create and delete posts and view posts from users or bands that user follows                                                                                    |
| M04: Bands                                  | Web resources for the band profile page. This module will have resources to create and delete band posts, view and modify band information and capabilities of inviting and removing band members as well as accept or reject band applications |
| M05: Chat                                   | Web resources for chat functionality, these resources include sending and receiving messages from users and bands                                                                                                                               |
| M06: Notifications                          | Web resources for management of notifications                                            |

## 2. Permissions

| Permission | Name          | Description                                          |
| ---------- | ------------- | ---------------------------------------------------- |
| PUB        | Public        | Priviliges for non-authenticated users               |
| USR        | User          | Privileges for authenticated users                   |
| OWN        | Own User      | Privileges for logged user                           |
| BOW        | Band Owner    | Privileges for band owners (on the band he/her owns) |
| ADM        | Administrator | Privileges for administrator users                   |


## 3. Modules

### 3.1 Module M01: Authentication And Indiviudal Profile

This section documents each web resource of each module, indicating the URL, HTTP methods, the possible parameters, interfaces with the user (referring to the A3 artefact) â€” or JSON responses in the event of APIs.

These are the endpoints available in the Authentication and Individual Profile Module.

    * R100: Home Page /
    * R101: Login Form /login
    * R102: Login Action /do_login
    * R103: Logout Action /do_logout
    * R104: Register Form /register
    * R105: Register Action /do_register
    * R106: View Profile /users/{id}
    * R107: Edit Profile Form /users/{id}/edit
    * R108: Edit Profile Action /users/do_edit/{id}
    * R109: Password Request Reset Form /request_password_reset
    * R110: Password Request Reset Action /do_request_password_reset
    * R111: Password Reset Form /users/{id}/reset_password
    * R112: Password Reset Action /users/{id}/do_reset_password



### R100

| R101        | Home Page                                                                                                       |
| ----------- | --------------------------------------------------------------------------------------------------------------- |
| URL         | /                                                                                                               |
| Description | Home page                                                                                                       |
| Method      | GET                                                                                                             |
| UI          | [UI01](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#user-content-ui01-homelogin) |
| PERMISSIONS | PUB                                                                                                             |

### R101

| R101        | Login Form                                                                                                      |
| ----------- | --------------------------------------------------------------------------------------------------------------- |
| URL         | /login                                                                                                          |
| Description | Page with login form                                                                                            |
| Method      | GET                                                                                                             |
| UI          | [UI01](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#user-content-ui01-homelogin) |
| SUBMIT      | [R102](#r102)                                                                                                   |
| PERMISSIONS | PUB                                                                                                             |


### R102

| R102         | Login Action                                                                                         |
| ------------ | ---------------------------------------------------------------------------------------------------- |
| URL          | /do_login                                                                                            |
| Description  | Web resource that logs the user, redirecting to user profile page if successful or login form if not |
| Method       | POST                                                                                                 |
| Request Body | +email:string                                 Username                                               |
|              | +password:string                              Password                                               |
| Redirects    | [R106](#r106)                                   Success                                              |
|              | [R100](#r100)                                   Error                                                |
| Permissions  | PUB                                                                                                  |



### R103

| R103        | Logout Action                                                                  |
| ----------- | ------------------------------------------------------------------------------ |
| URL         | /do_logout                                                                     |
| Description | Web resource that logs out the user                                            |
| Method      | POST                                                                           |
| Redirects   | [R100](#r100)                                                          Success |
| Permissions | USR, ADM                                                                       |


### R104


| R104        | Register Form                                                                                                  |
| ----------- | -------------------------------------------------------------------------------------------------------------- |
| URL         | /register                                                                                                      |
| Description | Page with a register form  to create a new user account                                                        |
| Method      | GET                                                                                                            |
| UI          | [UI04](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#user-content-ui04-register) |
| SUBMIT      | [R105](#r105)                                                                                                  |
| PERMISSIONS | PUB                                                                                                            |


### R105


| R105         | Register Action                                                                                                            |
| ------------ | -------------------------------------------------------------------------------------------------------------------------- |
| URL          | /do_register                                                                                                               |
| Description  | Web resource that inserts the user into the system, redirecting to user profile page if successful or register form if not |
| Method       | POST                                                                                                                       |
| Request Body | +email:string                                 Username                                                                     |
|              | +password:string                              Password                                                                     |
|              | +confirm_password:string                      Password   confirmation                                                      |
|              | +picture:file                                 Profile picture                                                              |
| Redirects    | [R100](#r100)                                   Success                                                                    |
|              | [R104](#r104)                                   Error                                                                      |
| Permissions  | PUB                                                                                                                        |


### R106


| R106        | View Profile                                                                                                  |
| ----------- | ------------------------------------------------------------------------------------------------------------- |
| URL         | /users/{id}                                                                                                   |
| Description | Shows the user individual profile page.                                                                       |
| Method      | GET                                                                                                           |
| Parameters  | +id: integer                                                                                 user primary key |
| UI          | [UI06](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#user-content-ui06-profile) |
| PERMISSIONS | OWN                                                                                                           |



### R107


| R107        | Edit Profile Form                                                    |
| ----------- | -------------------------------------------------------------------- |
| URL         | /users/{id}/edit                                                     |
| Description | Page with a form to edit profile info.                               |
| Method      | GET                                                                  |
| Parameters  | +id: integer                                        user primary key |
| UI          | Not yet implemented                                                  |
| SUBMIT      | [R108](#r108)                                                        |
| PERMISSIONS | OWN                                                                  |



### R108


| R108         | Edit Profile Action                                                                                                                                 |
| ------------ | --------------------------------------------------------------------------------------------------------------------------------------------------- |
| URL          | /users/do_edit/{id}                                                                                                                                 |
| Description  | Web resource that changes user profile info based on the input received. Redirects to the user profile on success and edit profile page on failure. |
| Method       | PUT                                                                                                                                                 |
| Parameteres  | +id: integer                                            user primary key                                                                            |
| Request Body | ?name:string                                  New name                                                                                              |
|              | ?picture:file                               New profile picture file                                                                                |
| Redirects    | [R106](#r106)          Success                                                                                                                      |
|              | [R107](#r107)          Error                                                                                                                        |
| Permissions  | OWN                                                                                                                                                 |




### R109

| R109        | Password Request Reset Form                                  |
| ----------- | ------------------------------------------------------------ |
| URL         | /request_password_reset                                      |
| Description | Page with a form to request an e-mail to reset the password. |
| Method      | GET                                                          |
| UI          | Not implmented yet                                           |
| SUBMIT      | [R110](#r110)                                                |
| PERMISSIONS | OWN                                                          |



### R110


| R110         | Password Request Reset Action                                         |
| ------------ | --------------------------------------------------------------------- |
| URL          | /do_request_password_reset                                            |
| Description  | Web resource that sends a reset password link to the specified email. |
| Method       | POST                                                                  |
| Request Body | +email:string                                User email               |
|              | +username:string                                User name             |
| Redirects    | [R100](#r100)          Success                                        |
|              | [R109](#r109)          Error                                          |
| Permissions  | PUB                                                                   |

### R111


| R111         | Password Reset Form                                        |
| ------------ | ---------------------------------------------------------- |
| URL          | /users/{id}/reset_password                                 |
| Description  | Web resource to specify new password                       |
| Method       | GET                                                        |
| Request Body | +id:integer                                        User id |
| UI           | Not implmented yet                                         |
| SUBMIT       | [R112](#r112)                                              |
| Permissions  | USR                                                        |

### R112


| R110         | Password Reset Action                                                |
| ------------ | -------------------------------------------------------------------- |
| URL          | /users/{id}/do_reset_password                                        |
| Description  | Web resource that changes password of the user                       |
| Method       | PUT                                                                  |
| Request Body | +password:string                                new password         |
|              | +confirm:string                                 confirm new password |
| Redirects    | [R100](#r100)          Success                                       |
|              | [R111](#r111)          Error                                         |
| Permissions  | PUB                                                                  |



### 3.2 Module M02: User Administration / Static Pages


These are the endpoints available in the Authentication and Individual Profile Module.

    * 201: Get users /users
    * 202: Change Privileges user API /admin_api/users/{id}/edit_privileges
    * 203: Get reported users /reported_users
    * 204: Ban/Unban User API /admin_api/users/{id}/ban_unban_user
    * 205: Get reported bands /reported_bands
    * 206: Ban/Unban Band API /admin_api/bands/{id}/ban_unban_band
    * 207: Get genres /genres
    * 208: Add Genre API /admin_api/genres/add_genre
    * 209: Edit Genre API /admin_api/genres/{id}/edit_genre
    * 210: Delete Genre API /admin_api/genres{id}/delete_genre
    * 211: Get skills /skills
    * 212: Add Skill API /admin_api/skills/add_skill
    * 213: Edit Skill API /admin_api/skills/{id}/edit_skill
    * 214: Delete Skill API /admin_api/skills{id}/delete_skill
    * 215: Get User Reports /users/{id}/reports
    * 216: Warn User API: /admin_api/users/{id}/reports/{id}/warn
    * 217: Get Band Reports: /bands/{id}/reports
    * 218: Warn Band API: /admin_api/bands/{id}/reports/{id}/warn
    * 219: Mark Report as seen API: /admin_api/users/{id}/reports/{id}/seen   
    * 220: About page /about
    * 221: FAQ page /faq

**R201** Get Users

| R201        | Get users                                           |
| ----------- | --------------------------------------------------- |
| URL         | /users                                              |
| Description | Get all users                                       |
| Method      | GET                                                 |
| Parameters  | ?offset: integer - offset to retrieve list of users |
| UI          | UI08                                                |
| AJAX Calls  | R202                                                |
| Permissions | ADM                                                 |

**R202** Change Privileges API

| R202          | Change Privileges API                                                                  |
| ------------- | -------------------------------------------------------------------------------------- |
| URL           | /admin_api/users/{id}/edit_privileges                                                  |
| Description   | Change user permissions, either promoting him to admin or relegating him to basic user |
| Method        | PUT                                                                                    |
| Parameters    | ?id: integer - user id                                                                 |
|               | ?admin: boolean - if it is to promote or relegate user                                 |
| Response body | JSON 201                                                                               |
| Permissions   | ADM                                                                                    |

**R203** Get reported users

| R203        | Get reported users                                           |
| ----------- | ------------------------------------------------------------ |
| URL         | /reported_users                                              |
| Description | Get a list of reported users                                 |
| Method      | GET                                                          |
| Parameters  | ?offset: integer - offset to retrieve list of reported users |
| UI          | UI09                                                         |
| AJAX Calls  | R204                                                         |
| Permissions | ADM                                                          |

**R204** Ban/Unban User API

| R204          | Ban/Unban User API                                              |
| ------------- | --------------------------------------------------------------- |
| URL           | /admin_api/users/{id}/ban_unban_user                            |
| Description   | Ban or unban a user                                             |
| Parameters    | ?userId: integer - user id                                      |
|               | ?loggedUserId: integer - current logegd user to save who banned |
|               | ?ban: boolean - if it is to ban or unban user                   |
| Response body | JSON 202                                                        |
| Permissions   | ADM                                                             |


**R205** Get reported bands

| R205        | Get reported bands                                           |
| ----------- | ------------------------------------------------------------ |
| URL         | /reported_bands                                              |
| Description | Get a list of reported bands                                 |
| Method      | GET                                                          |
| Parameters  | ?offset: integer - offset to retrieve list of reported bands |
| UI          | UI09                                                         |
| AJAX Calls  | R206                                                         |
| Permissions | ADM                                                          |

**R206** Ban/Unban Band API

| R206          | Ban/Unban Band API                                              |
| ------------- | --------------------------------------------------------------- |
| URL           | /admin_api/users/{id}/ban_unban_user                            |
| Description   | Ban or unban a user                                             |
| Parameters    | ?bandId: integer - band id                                      |
|               | ?loggedUserId: integer - current logegd user to save who banned |
|               | ?ban: boolean - if it is to ban or unban user                   |
| Response body | JSON 203                                                        |
| Permissions   | ADM                                                             |

**R207** Get genres

| R207        | Get genres       |
| ----------- | ---------------- |
| URL         | /genres          |
| Description | Get all genres   |
| Method      | GET              |
| UI          | UI10             |
| AJAX Calls  | R208, R209, R210 |
| Permissions | ADM              |

**R208** Add Genre API

| R208          | Add Genre API                                                    |
| ------------- | ---------------------------------------------------------------- |
| URL           | /admin_api/genres/add_genre                                      |
| Description   | Add a new genre                                                  |
| Method        | POST                                                             |
| Parameters    | ?name: string - genre name                                       |
|               | ?loggedUserId: integer - current logegd user to save who created |
| Response body | JSON 204                                                         |
| Permissions   | ADM                                                              |

**R209** Edit Genre API

| R209          | Edit Genre API                                                    |
| ------------- | ----------------------------------------------------------------- |
| URL           | /admin_api/genres/{id}/edit_genre                                 |
| Description   | Edit a genre                                                      |
| Method        | PUT                                                               |
| Parameters    | ?id: integer - genre id to edit                                   |
|               | ?loggedUserId: integer - current logegd user to save who modified |
| Response body | JSON 204                                                          |
| Permissions   | ADM                                                               |

**R210** Delete Genre API

| R210          | Delete Genre API                                                                                               |
| ------------- | -------------------------------------------------------------------------------------------------------------- |
| URL           | /admin_api/genres/{id}/delete_genre                                                                            |
| Description   | Delete a genre (actually inactivate it, the field active of json response will come false if genre is deleted) |
| Method        | DELETE                                                                                                         |
| Parameters    | ?id: integer - genre id to delete                                                                              |
|               | ?loggedUserId: integer - current logegd user to save who modified                                              |
| Response body | JSON 204                                                                                                       |
| Permissions   | ADM                                                                                                            |

**R211** Get skills

| R211                | Get skills       |
| ------------------- | ---------------- |
| URL                 | /skills          |
| Description         | Get all skills   |
| Method              | GET              |
| Not yet Implemented |
| AJAX Calls          | R212, R213, R214 |
| Permissions         | ADM              |

**R212** Add Skill API

| R212          | Add Skill API                                                    |
| ------------- | ---------------------------------------------------------------- |
| URL           | /admin_api/skills/add_skill                                      |
| Description   | Add a new skill                                                  |
| Method        | POST                                                             |
| Parameters    | ?name: string - skill name                                       |
|               | ?loggedUserId: integer - current logegd user to save who created |
| Response body | JSON 205                                                         |
| Permissions   | ADM                                                              |

**R213** Edit Skill API

| R213          | Edit Skill API                                                    |
| ------------- | ----------------------------------------------------------------- |
| URL           | /admin_api/skills/{id}/edit_skill                                 |
| Description   | Edit a skill                                                      |
| Method        | PUT                                                               |
| Parameters    | ?id: integer - skill id to edit                                   |
|               | ?loggedUserId: integer - current logegd user to save who modified |
| Response body | JSON 205                                                          |
| Permissions   | ADM                                                               |

**R214** Delete Skill API

| R214          | Delete Skill API                                                                                               |
| ------------- | -------------------------------------------------------------------------------------------------------------- |
| URL           | /admin_api/skills/{id}/delete_skill                                                                            |
| Description   | Delete a skill (actually inactivate it, the field active of json response will come false if skill is deleted) |
| Method        | DELETE                                                                                                         |
| Parameters    | ?id: integer - skill id to delete                                                                              |
|               | ?loggedUserId: integer - current logegd user to save who modified                                              |
| Response body | JSON 205                                                                                                       |
| Permissions   | ADM                                                                                                            |


**R215** Get User Reports

| R215        | Get User Reports            |
| ----------- | --------------------------- |
| URL         | /users/{id}/reports         |
| Description | Get all reports from a user |
| Method      | GET                         |
| Parameters  | ?id: integer - user id      |
| UI          | Not yet implemented         |
| AJAX Calls  | R216, R219                  |
| Permissions | ADM                         |

**R216** Warn User API

| R216          | Warn User API                                                                   |
| ------------- | ------------------------------------------------------------------------------- |
| URL           | /admin_api/users/{id}/reports/{id}/warn                                         |
| Description   | Gives a warning to the user                                                     |
| Method        | POST                                                                            |
| Parameters    | ?userId: integer - user id                                                      |
|               | ?reportId: integer - report id who originates the warn                          |
|               | ?loggedUserId: integer - current logegd user to save as admin who gave the warn |
|               | ?text: string - the text of the warning                                         |
| Response body | JSON 206                                                                        |
| Permissions   | ADM                                                                             |


**R217** Get Band Reports

| R217                | Get Band Reports            |
| ------------------- | --------------------------- |
| URL                 | /bands/{id}/reports         |
| Description         | Get all reports from a band |
| Method              | GET                         |
| Parameters          | ?id: integer - band id      |
| Not yet implemented |
| AJAX Calls          | R218, R219                  |
| Permissions         | ADM                         |

**R218** Warn Band API

| R218          | Warn Band API                                                                   |
| ------------- | ------------------------------------------------------------------------------- |
| URL           | /admin_api/bands/{id}/reports/{id}/warn                                         |
| Description   | Gives a warning to the band                                                     |
| Method        | POST                                                                            |
| Parameters    | ?bandId: integer - band id                                                      |
|               | ?reportId: integer - report id who originates the warn                          |
|               | ?loggedUserId: integer - current logegd user to save as admin who gave the warn |
|               | ?text: string - the text of the warning                                         |
| Response body | JSON 206                                                                        |
| Permissions   | ADM                                                                             |


**R219** Mark Report as Seen API

| R219          | Mark Report as Seen API                          |
| ------------- | ------------------------------------------------ |
| URL           | /admin_api/users/{id}/reports/{id}/seen          |
| Description   | Mark the report as seen                          |
| Method        | PUT                                              |
| Parameters    | ?reportId: integer - report id                   |
| Response body | Check HTTP return code 200 - success, 403 - fail |
| Permissions   | ADM                                              |

**R220** About Page

| R220        | About Page     |
| ----------- | -------------- |
| URL         | /about         |
| Description | Get about page |
| Method      | GET            |
| UI          | UI02           |
| Permissions | PUB            |

**R221** FAQ Page

| R221        | FAQ Page     |
| ----------- | ------------ |
| URL         | /faq         |
| Description | Get faq page |
| Method      | GET          |
| UI          | UI03         |
| Permissions | PUB          |

**R222** Page not found

| R221        | Page not found      |
| ----------- | ------------------- |
| URL         | /404                |
| Description | Page not found      |
| Method      | GET                 |
| UI          | Not yet implemented |
| Permissions | PUB                 |


## 3.3 M03: User Feed

These are the endpoints available in the User Feed Module.

    * R301: Get Posts /users/{id}/posts
    * R302: Get Posts API /api/users/{id}/posts
    * R303: Delete Post /users/{userId}/posts/{postId}/delete_post
    * R304: Delete Post API /api/users/{userId}/posts/{postId}/delete_post
    * R305: Create Post /users/{userId}/create_post
    * R306: Create Post API /api/users/{userId}/create_post
    * R307: Edit Post /users/{userId}/edit_post
    * R308: Edit Post API /api/users/{userId}/edit_post
    * R309: Get Comments /posts/{postId}/comments 
    * R310: Get Comments API /api/posts/{postId}/comments 
    * R311: Delete Comment /posts/{postId}/comments/{commentId}/delete_comment
    * R312: Delete Comment API /api/posts/{postId}/comments/{commentId}/delete_comment
    * R313: Create Comment /posts/{postId}/create_comment
    * R314: Create Comment API /api/posts/{postId}/create_comment/{commentId}
    * R315: Edit Comment /posts/{postId}/edit_comment
    * R316: Edit Comment API /api/posts/{postId}/edit_comment/{commentId}

### R301
<<<<<<< HEAD
|  R301         |  Get Posts                                                                                                     |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /users/{id}/posts                                                                                        |
|  Description  | Web resource that gets the posts from users and bands the user follows and his own                             |
|   Method      |       GET                                                                                                      |
| Parameters    | ?offset: integer                          |   Offset to retrieve list of posts                                 |
|               | +id: integer                              |   User primary key                                                 |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R302](#r302)                                                                                                |
|  Permissions  |  USR                                                                                                           |

### R302
|  R302         |  Get Posts API                                                                                                 |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/users/{id}/posts                                                                                    |
|  Description  | Web resource that searches the system for posts and returns the results                                        |
|   Method      |       GET                                                                                                      |
| Parameters    | ?offset: integer                          |   Offset to retrieve list of posts                                 |
|               | +id: integer                              |   User primary key                                                 |
| Response Body |   [JSON302](#json302)                                                                                          |
|  Permissions  |  USR                                                                                                           |

### R303
|  R303         |  Delete Post                                                                                                   |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /users/{userId}/posts/{postId}/delete_post                                                               |
|  Description  | Web resource that deletes a post from the system                                                               |
|   Method      |       DELETE                                                                                                   |
| Parameters    | +postId:integer                           |   Post primary key                                                 |
|               | +userId: integer                          |   User primary key                                                 |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R304](#r304)                                                                                                |
|  Permissions  |  OWN                                                                                                           |

### R304
|  R304         |  Delete Post API                                                                                               |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/users/{userId}/posts/{postId}/delete_post                                                           |
|  Description  | Web resource that checks if the post was well deleted                                                          |
|   Method      |       DELETE                                                                                                   |
| Parameters    | +postId:integer                           |   Post primary key                                                 |
|               | +userId: integer                          |   User primary key                                                 |
| Response Body |   [JSON304](#json304)                                                                                          |
|  Permissions  |  OWN                                                                                                           |

### R305
|  R305         |  Create Post                                                                                                   |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /users/{userId}/create_post                                                                              |
|  Description  | Web resource that creates a post and inserts in the system                                                     |
|   Method      |       POST                                                                                                     |
| Parameters    | +userId: integer                          |   User primary key                                                 |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R306](#r306)                                                                                                |
|  Permissions  |  USR                                                                                                           |

### R306
|  R306         |  Create Post API                                                                                               |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/users/{userId}/create_post/{postId}                                                                 |
|  Description  | Web resource that checks if the post was well created                                                          |
|   Method      |       POST                                                                                                     |
| Parameters    | +postId:integer                           |   Post primary key                                                 |
|               | +userId: integer                          |   User primary key                                                 |
| Response Body |   [JSON306](#json306)                                                                                          |
|  Permissions  |  USR                                                                                                           |

### R307
|  R307         |  Edit Post                                                                                                     |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /users/{userId}/edit_post                                                                                |
|  Description  | Web resource that edits a post and updates the system                                                          |
|   Method      |       PUT                                                                                                      |
| Parameters    | +userId: integer                          |   User primary key                                                 |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R308](#r308)                                                                                                |
|  Permissions  |  OWN                                                                                                           |

### R308
|  R308         |  Edit Post API                                                                                                 |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/users/{userId}/edit_post/{postId}                                                                   |
|  Description  | Web resource that checks if the post was well edited and updated                                               |
|   Method      |       PUT                                                                                                      |
| Parameters    | +postId:integer                           |   Post primary key                                                 |
|               | +userId: integer                          |   User primary key                                                 |
| Response Body |   [JSON308](#json308)                                                                                          |
|  Permissions  |  OWN                                                                                                           |

### R309
|  R309         |  Get Comments                                                                                                  |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /posts/{postId}/comments                                                                                 |
|  Description  | Web resource that gets the comments belonging to a post                                                        |
|   Method      |       GET                                                                                                      |
| Parameters    | +postId:integer                           |   Post primary key                                                 |
|               | ?offset: integer                          |   Offset to retrieve list of comments                              |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R310](#r310)                                                                                                |
|  Permissions  |  USR                                                                                                           |

### R310
|  R310         |  Get Comments API                                                                                              |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/posts/{postId}/comments                                                                             |
|  Description  | Web resource that searches the system for comments and returns the results                                     |
|   Method      |       GET                                                                                                      |
| Parameters    | +postId:integer                           |   Post primary key                                                 |
|               | ?offset: integer                          |   Offset to retrieve list of comments                              |
| Response Body |   [JSON310](#json310)                                                                                          |
|  Permissions  |  USR                                                                                                           |

### R311
|  R311         |  Delete Comment                                                                                                |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /posts/{postId}/comments/{commentId}/delete_comment                                                      |
|  Description  | Web resource that deletes a comment from the system                                                            |
|   Method      |       DELETE                                                                                                   |
| Parameters    | +postId:integer                           |   Post primary key                                                 |
|               | +commentId:integer                        |   Comment primary key                                              |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R312](#r312)                                                                                                |
|  Permissions  |  OWN                                                                                                           |

### R312
|  R312         |  Delete Comment API                                                                                            |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/posts/{postId}/comments/{commentId}/delete_comment                                                  |
|  Description  | Web resource that checks if the comment was well deleted                                                       |
|   Method      |       DELETE                                                                                                   |
| Parameters    | +postId:integer                           |   Post primary key                                                 |
|               | +commentId:integer                        |   Comment primary key                                              |
| Response Body |   [JSON312](#json312)                                                                                          |
|  Permissions  |  OWN                                                                                                           |

### R313
|  R313         |  Create Comment                                                                                                |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /posts/{postId}/create_comment                                                                           |
|  Description  | Web resource that creates a comment and inserts in the system                                                  |
|   Method      |       POST                                                                                                     |
| Parameters    | +commentId:integer                        |   Comment primary key                                              |
|               | +userId:integer                           |   User primary key                                                 |
|               | +postId:integer                           |   Post primary key                                                 |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R314](#r314)                                                                                                |
|  Permissions  |  USR                                                                                                           |

### R314
|  R314         |  Create Comment API                                                                                            |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/posts/{postId}/create_comment/{commentId}                                                           |
|  Description  | Web resource that checks if the comment was well created                                                       |
|   Method      |       POST                                                                                                     |
| Parameters    | +commentId:integer                        |   Comment primary key                                              |
|               | +userId:integer                           |   User primary key                                                 |
|               | +postId:integer                           |   Post primary key                                                 |
| Response Body |   [JSON314](#json314)                                                                                          |
|  Permissions  |  USR                                                                                                           |

### R315
|  R315         |  Edit Comment                                                                                                  |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /posts/{postId}/edit_comment                                                                             |
|  Description  | Web resource that edits a comment and updates the system                                                       |
|   Method      |       PUT                                                                                                      |
| Parameters    | +postId:integer                           |   Post primary key                                                 |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R316](#r316)                                                                                                |
|  Permissions  |  OWN                                                                                                           |

### R316
|  R316         |  Edit Comment API                                                                                              |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/posts/{postId}/edit_comment/{commentId}                                                             |
|  Description  | Web resource that checks if the comment was well edited and updated                                            |
|   Method      |       PUT                                                                                                      |
| Parameters    | +commentId:integer                        |   Comment primary key                                              |
|               | +userId:integer                           |   User primary key                                                 |
|               | +postId:integer                           |   Post primary key                                                 |
| Response Body |   [JSON316](#json316)                                                                                          |
|  Permissions  |  OWN                                                                                                           |


## M04: Bands

These are the endpoints available in the Band Module.

    * R401: Make post form              /band/{bandID}/new_post
    * R402: Make post action            /band/{bandID}/do_new_post
    * R403: Delete post                 /band/{bandID}/post/{postID}/delete
    * R404: View band profile           /band/{bandID}
    * R405: Edit band profile form      /band/{bandID}/edit_band
    * R406: Edit band profile action    /band/{bandID}/edit_band
    * R407: Invite band member          /band/{bandID}/members/send_invite/user/{userID}
    * R408: Remove band member          /band/{bandID}/members/remove/user/{userID}
    * R409: Accept application         /band/{bandID}/applications/user/{userID}
    * R410: Reject application         /band/{bandID}/applications/user/{userID}

    

### R401    

| R401        | Make Post Form          |
| ----------- | ----------------------- |
| URL         | /band/{bandID}/new_post |
| Description | New band post form      |
| Method      | GET                     |
| UI          | Not yet implemented     |
| SUBMIT      | [R402](#r402)           |
| PERMISSIONS | OWN                     |


### R402

| R402         | Make Post Action                                               |
| ------------ | -------------------------------------------------------------- |
| URL          | /band/{bandID}/new_post                                        |
| Description  | Web resource that creates the post                             |
| Method       | POST                                                           |
| Request Body | +text:string                                 Post body message |
| Redirects    | [R404](#r404)                                   Success        |
|              | [R401](#r401)                                   Error          |
| Permissions  | OWN                                                            |


### R403


| R403        | Delete Post                                           |
| ----------- | ----------------------------------------------------- |
| URL         | /band/{bandID}/post/{postID}/delete                   |
| Description | Web resource that deletes a band post from the system |
| Method      | GET                                                   |
| Parameters  | +postId:integer                                       | Post Id |
| UI          | Not yet implemented                                   |
| AJAX Calls  | [R411](#411)                                          |
| Permissions | OWN, ADM, BOW                                         |


### R404


| R404        | View Band Profile            |
| ----------- | ---------------------------- |
| URL         | /band/{bandID}               |
| Description | Shows the band profile page. |
| Method      | GET                          |
| Parameters  | +bandID: integer             | band primary key |
| UI          | Not yet implemented          |
| PERMISSIONS | OWN, ADM                     |


### R405


| R405        | Edit Band Profile Form                                                   |
| ----------- | ------------------------------------------------------------------------ |
| URL         | /band/{bandID}/edit_band                                                 |
| Description | Page with a form to edit band profile info.                              |
| Method      | GET                                                                      |
| Parameters  | +bandID: integer                                        band primary key |
| UI          | Not yet implemented                                                      |
| SUBMIT      | [R406](#r406)                                                            |
| PERMISSIONS | BOW                                                                      |


### R406


| R406         | Edit Band Profile Action                                                     |
| ------------ | ---------------------------------------------------------------------------- |
| URL          | /band/{bandID}/edit_band                                                     |
| Description  | Web resource that changes band profile info based on the input received.     |
| Method       | POST                                                                         |
| Parameteres  | +bandID: integer                                            band primary key |
| Request Body | ?name:string                                  New name                       |
|              | ?picture:file                               Band profile picture             |
| Redirects    | [R404](#r404)          Success                                               |
|              | [R405](#r405)          Error                                                 |
| Permissions  | BOW                                                                          |


### R407


| R407         | Invite Band Member                                                      |
| ------------ | ----------------------------------------------------------------------- |
| URL          | /band/{bandID}/members/send_invite/user/{userID}                        |
| Description  | Web resource that sends an invite notification to a future band memeber |
| Method       | POST                                                                    |
| Request Body | +userID:integer                                 User ID                 |
| Redirects    | [R404](#r404)                                   Success                 |
|              | [R407](#r407)                                   Error                   |
| Permissions  | BOW                                                                     |

### R408


| R407         | Remove Band Member                                      |
| ------------ | ------------------------------------------------------- |
| URL          | /band/{bandID}/members/remove/user/{userID}             |
| Description  | Web resource that removes a band member                 |
| Method       | POST                                                    |
| Request Body | +userID:integer                                 User ID |
| Redirects    | [R404](#r404)                                   Success |
|              | [R408](#r408)                                   Error   |
| Permissions  | BOW                                                     |

### R409 

| R407         | Accept Member Application                                   |
| ------------ | ----------------------------------------------------------- |
| URL          | /band/{bandID}/applications/user/{userID}                   |
| Description  | Web resource that accepts a member application from an user |
| Method       | POST                                                        |
| Request Body | +userID:integer                                 User ID     |
| Redirects    | [R404](#r404)                                   Success     |
|              | [R409](#r409)                                   Error       |
| Permissions  | BOW                                                         |



### R410 


| R407         | Reject Member Application                                   |
| ------------ | ----------------------------------------------------------- |
| URL          | /band/{bandID}/applications/user/{userID}                   |
| Description  | Web resource that rejects a member application from an user |
| Method       | POST                                                        |
| Request Body | +id:integer                                 User ID         |
| Redirects    | [R404](#r404)                                   Success     |
|              | [R409](#r410)                                   Error       |
| Permissions  | BOW                                                         |


### R411

| R411          | Delete Posts API                                         |
| ------------- | -------------------------------------------------------- |
| URL           | /api/delete_post                                         |
| Description   | Web resource that deletes a certain post from the system |
| Method        | GET                                                      |
| Parameters    | +postID:integer                                          | Post Id |
| Response Body | [JSON401](#json401)                                      |
| Permissions   | PUB                                                      |


## M05: Chat

These are the endpoints available in the Chat Module.

    * R501: Get Messages /users/{receiverId}/messages
    * R502: Get Messages API /api/users/{receiverId}/messages
    * R503: Send Message /users/{senderId}/send_message/{messageId}
    * R504: Send Message API /api/users/{senderId}/send_message/{messageId}

### R501    
|  R501         |  Get Messages                                                                                                  |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /users/{receiverId}/messages                                                                             |
|  Description  | Web resource that gets the messages for a chat conversation                                                    |
|   Method      |       GET                                                                                                      |
| Parameters    | +senderId:integer                           |   Sender Id                                                      |
|               | +receiverId:integer                         |   Receiver Id                                                    |
|               | ?offset: integer                            |   Offset to retrieve list of messages                            |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R502](#r502)                                                                                                |
|  Permissions  |  USR                                                                                                           |

### R502
|  R502         |  Get Messages API                                                                                              |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/users/{receiverId}/messages                                                                         |
|  Description  | Web resource that searches the system for messages and returns the results                                     |
|   Method      |       GET                                                                                                      |
| Parameters    | +senderId:integer                           |   Sender Id                                                      |
|               | +receiverId:integer                         |   Receiver Id                                                    |
|               | ?offset: integer                            |   Offset to retrieve list of messages                            |
| Response Body |   [JSON502](#json502)                                                                                          |
|  Permissions  |  USR                                                                                                           |

### R503
|  R503         |  Send Message                                                                                                  |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /users/{senderId}/send_message/{messageId}                                                               |
|  Description  | Web resource that creates a message, sends it and inserts in the system                                        |
|   Method      |       POST                                                                                                     |
| Parameters    | +senderId:integer                           |   Sender Id                                                      |
|               | +receiverId:integer                         |   Receiver Id                                                    |
| UI            |   [UI05](https://github.com/joaopedrofump/lbaw1712/wiki/A3:-User-Interface-Prototype#ui05-feed)                |
|  AJAX Calls   |   [R504](#r504)                                                                                                |
|  Permissions  |  USR                                                                                                           |

### R504
|  R504         |  Send Message API                                                                                              |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/users/{senderId}/send_message/{messageId}                                                           |
|  Description  | Web resource that checks if the message was well created, sent and stored                                      |
|   Method      |       POST                                                                                                     |
| Parameters    | +senderId:integer                           |   Sender Id                                                      |
|               | +receiverId:integer                         |   Receiver Id                                                    |
| Response Body |   [JSON504](#json504)                                                                                          |
|  Permissions  |  USR                                                                                                           |


## M06: User Notifications

These are the endpoints available in the User Notifications Module.

    * R601: Get Notifications /
    * R602: Get Notifications API /api/users/{userId}/notifications

### R601    
|  R601         |  Get Notifications                                                                                             |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |   /                                                                                                            |
|  Description  | Web resource that gets the notifications                                                                       |
|   Method      |       GET                                                                                                      |
|  AJAX Calls   |   [R602](#r602)                                                                                                |
|  Permissions  |  USR                                                                                                           |

### R602
|  R602         |  Get Notifications API                                                                                         |
|---------------|----------------------------------------------------------------------------------------------------------------|
|     URL       |       /api/users/{userId}/notifications                                                                        |
|  Description  | Web resource that searches the system for notifications and returns the results                                |
|   Method      |       GET                                                                                                      |
| Response Body |   [JSON602](#json602)                                                                                          |
|  Permissions  |  USR                                                                                                           |


### 4.JSON/XML Types

### JSON 201: {user_privilege}
```json

{
    "id": 3,
    "admin" : true
    
}


```


### JSON 202: {user_is_banned}
```json

{
    "id": 5,
    "banned" : true
    
}


```


### JSON 203: {band_is_banned}
```json

{
    "id": 1,
    "banned" : true
    
}


```


### JSON 204: {genre}
```json

{
    "id": 19,
    "name" : "rock",
    "creatingAdmin": 1,
    "isActive":true
    
}


```


### JSON 205: {skill}
```json

{
    "id": 21,
    "name" : "drums",
    "creatingAdmin": 1,
    "isActive":true
    
}


```


### JSON 206: {warn/read}
```json

{
    "success": true,
    
}


```


### JSON302
```json
{
    "posts": [
        {
            "id": "1",
            "date":"01/04/2018 17:21:08",
            "text": "sdfsfdsgdfgdh",
            "author": {
                "id": 34,
                "name": "JoÃ£o Pedro"
            }
        },

        {
            "id": "3",
            "date":"31/03/2018 18:31:01",
            "text": "sdfsfsdfsdgdfgfdgdsgdfgdh",
            "author": {
                "id": 22,
                "name": "Danny"
            }
        },

        {
            "id": "6",
            "date":"31/03/2018 17:31:21",
            "text": "sdfsfssdfsdgsfdfsdgdfgfdgdsgdfgdh",
            "author": {
                "id": 12,
                "name": "JoÃ£o Conde"
            }
        }

    ]
}
```


### JSON304
```json
{
    "id": "1",
    "wasDeleted": "true"
}
```


### JSON306
```json
{
    "id": "1",
    "wasCreated": "true"
}
```


### JSON308
```json
{
    "id": "1",
    "wasEdited": "true"
}
```


### JSON310
```json
{
    "comments": [
        {
            "id": "1",
            "text": "Very nice post",
            "author": {
                "id": 34,
                "name": "JoÃ£o Pedro"
            }
        },

        {
            "id": "3",
            "text": "Thanks JoÃ£o",
            "author": {
                "id": 22,
                "name": "Danny"
            }
        },

        {
            "id": "6",
            "text": "Which JoÃ£o?",
            "author": {
                "id": 12,
                "name": "JoÃ£o Conde"
            }
        }

    ]
}
```


### JSON312
```json
{
    "id": "1",
    "wasDeleted": "true"
}
```


### JSON314
```json
{
    "id": "1",
    "wasCreated": "true"
}
```


### JSON316
```json
{
    "id": "1",
    "wasEdited": "true"
}
```


### JSON401
```json

{
    "post_id": 5,
    "was_deleted" : true
    
}


```


### JSON502
```json
{
    "messages": [
        {
            "id": "1",
            "text": "Hello",
            "date":"31/03/2018 17:31:21",
            "author": {
                "id": 34,
                "name": "JoÃ£o Pedro"
            }
        },

        {
            "id": "2",
            "text": "How are you?",
            "date":"31/03/2018 17:32:11",
            "author": {
                "id": 22,
                "name": "Danny"
            }
        }

    ]
}
```


### JSON504
```json
{
    "id": "1",
    "wasCreated": "true"
}
```


### JSON602
```json
{
    "notifications": [
        {
            "id": "1",
            "date":"01/04/2018 17:21:08",
            "text": "Danny Soares followed you",
        }
    ]
}

```